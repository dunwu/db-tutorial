(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{384:function(t,s,e){"use strict";e.r(s);var a=e(4),r=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"redis-åº”ç”¨æŒ‡å—"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#redis-åº”ç”¨æŒ‡å—"}},[t._v("#")]),t._v(" Redis åº”ç”¨æŒ‡å—")]),t._v(" "),s("h2",{attrs:{id:"ä¸€ã€redis-ç®€ä»‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€ã€redis-ç®€ä»‹"}},[t._v("#")]),t._v(" ä¸€ã€Redis ç®€ä»‹")]),t._v(" "),s("blockquote",[s("p",[t._v("Redis æ˜¯é€Ÿåº¦éå¸¸å¿«çš„éå…³ç³»å‹ï¼ˆNoSQLï¼‰å†…å­˜é”®å€¼æ•°æ®åº“ï¼Œå¯ä»¥å­˜å‚¨é”®å’Œäº”ç§ä¸åŒç±»å‹çš„å€¼ä¹‹é—´çš„æ˜ å°„ã€‚")]),t._v(" "),s("p",[t._v("é”®çš„ç±»å‹åªèƒ½ä¸ºå­—ç¬¦ä¸²ï¼Œå€¼æ”¯æŒçš„äº”ç§ç±»å‹æ•°æ®ç±»å‹ä¸ºï¼šå­—ç¬¦ä¸²ã€åˆ—è¡¨ã€é›†åˆã€æœ‰åºé›†åˆã€æ•£åˆ—è¡¨ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"redis-ä½¿ç”¨åœºæ™¯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#redis-ä½¿ç”¨åœºæ™¯"}},[t._v("#")]),t._v(" Redis ä½¿ç”¨åœºæ™¯")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("ç¼“å­˜")]),t._v(" - å°†çƒ­ç‚¹æ•°æ®æ”¾åˆ°å†…å­˜ä¸­ï¼Œè®¾ç½®å†…å­˜çš„æœ€å¤§ä½¿ç”¨é‡ä»¥åŠè¿‡æœŸæ·˜æ±°ç­–ç•¥æ¥ä¿è¯ç¼“å­˜çš„å‘½ä¸­ç‡ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("è®¡æ•°å™¨")]),t._v(" - Redis è¿™ç§å†…å­˜æ•°æ®åº“èƒ½æ”¯æŒè®¡æ•°å™¨é¢‘ç¹çš„è¯»å†™æ“ä½œã€‚")]),t._v(" "),s("li",[s("strong",[t._v("åº”ç”¨é™æµ")]),t._v(" - é™åˆ¶ä¸€ä¸ªç½‘ç«™è®¿é—®æµé‡ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("æ¶ˆæ¯é˜Ÿåˆ—")]),t._v(" - ä½¿ç”¨ List æ•°æ®ç±»å‹ï¼Œå®ƒæ˜¯åŒå‘é“¾è¡¨ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("æŸ¥æ‰¾è¡¨")]),t._v(" - ä½¿ç”¨ HASH æ•°æ®ç±»å‹ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("äº¤é›†è¿ç®—")]),t._v(" - ä½¿ç”¨ SET ç±»å‹ï¼Œä¾‹å¦‚æ±‚ä¸¤ä¸ªç”¨æˆ·çš„å…±åŒå¥½å‹ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("æ’è¡Œæ¦œ")]),t._v(" - ä½¿ç”¨ ZSET æ•°æ®ç±»å‹ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("åˆ†å¸ƒå¼ Session")]),t._v(" - å¤šä¸ªåº”ç”¨æœåŠ¡å™¨çš„ Session éƒ½å­˜å‚¨åˆ° Redis ä¸­æ¥ä¿è¯ Session çš„ä¸€è‡´æ€§ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("åˆ†å¸ƒå¼é”")]),t._v(" - é™¤äº†å¯ä»¥ä½¿ç”¨ SETNX å®ç°åˆ†å¸ƒå¼é”ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å®˜æ–¹æä¾›çš„ RedLock åˆ†å¸ƒå¼é”å®ç°ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"redis-çš„ä¼˜åŠ¿"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#redis-çš„ä¼˜åŠ¿"}},[t._v("#")]),t._v(" Redis çš„ä¼˜åŠ¿")]),t._v(" "),s("ul",[s("li",[t._v("æ€§èƒ½æé«˜ â€“ Redis èƒ½è¯»çš„é€Ÿåº¦æ˜¯ 110000 æ¬¡/s,å†™çš„é€Ÿåº¦æ˜¯ 81000 æ¬¡/sã€‚")]),t._v(" "),s("li",[t._v("ä¸°å¯Œçš„æ•°æ®ç±»å‹ - æ”¯æŒå­—ç¬¦ä¸²ã€åˆ—è¡¨ã€é›†åˆã€æœ‰åºé›†åˆã€æ•£åˆ—è¡¨ã€‚")]),t._v(" "),s("li",[t._v("åŸå­ - Redis çš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ã€‚å•ä¸ªæ“ä½œæ˜¯åŸå­æ€§çš„ã€‚å¤šä¸ªæ“ä½œä¹Ÿæ”¯æŒäº‹åŠ¡ï¼Œå³åŸå­æ€§ï¼Œé€šè¿‡ MULTI å’Œ EXEC æŒ‡ä»¤åŒ…èµ·æ¥ã€‚")]),t._v(" "),s("li",[t._v("æŒä¹…åŒ– - Redis æ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ã€‚å¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åœ¨ç£ç›˜ä¸­ï¼Œé‡å¯çš„æ—¶å€™å¯ä»¥å†æ¬¡åŠ è½½è¿›è¡Œä½¿ç”¨ã€‚")]),t._v(" "),s("li",[t._v("å¤‡ä»½ - Redis æ”¯æŒæ•°æ®çš„å¤‡ä»½ï¼Œå³ master-slave æ¨¡å¼çš„æ•°æ®å¤‡ä»½ã€‚")]),t._v(" "),s("li",[t._v("ä¸°å¯Œçš„ç‰¹æ€§ - Redis è¿˜æ”¯æŒå‘å¸ƒè®¢é˜…, é€šçŸ¥, key è¿‡æœŸç­‰ç­‰ç‰¹æ€§ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"redis-ä¸-memcached"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#redis-ä¸-memcached"}},[t._v("#")]),t._v(" Redis ä¸ Memcached")]),t._v(" "),s("p",[t._v("Redis ä¸ Memcached å› ä¸ºéƒ½å¯ä»¥ç”¨äºç¼“å­˜ï¼Œæ‰€ä»¥å¸¸å¸¸è¢«æ‹¿æ¥åšæ¯”è¾ƒï¼ŒäºŒè€…ä¸»è¦æœ‰ä»¥ä¸‹åŒºåˆ«ï¼š")]),t._v(" "),s("p",[s("strong",[t._v("æ•°æ®ç±»å‹")])]),t._v(" "),s("ul",[s("li",[t._v("Memcached ä»…æ”¯æŒå­—ç¬¦ä¸²ç±»å‹ï¼›")]),t._v(" "),s("li",[t._v("è€Œ Redis æ”¯æŒäº”ç§ä¸åŒç§ç±»çš„æ•°æ®ç±»å‹ï¼Œä½¿å¾—å®ƒå¯ä»¥æ›´çµæ´»åœ°è§£å†³é—®é¢˜ã€‚")])]),t._v(" "),s("p",[s("strong",[t._v("æ•°æ®æŒä¹…åŒ–")])]),t._v(" "),s("ul",[s("li",[t._v("Memcached ä¸æ”¯æŒæŒä¹…åŒ–ï¼›")]),t._v(" "),s("li",[t._v("Redis æ”¯æŒä¸¤ç§æŒä¹…åŒ–ç­–ç•¥ï¼šRDB å¿«ç…§å’Œ AOF æ—¥å¿—ã€‚")])]),t._v(" "),s("p",[s("strong",[t._v("åˆ†å¸ƒå¼")])]),t._v(" "),s("ul",[s("li",[t._v("Memcached ä¸æ”¯æŒåˆ†å¸ƒå¼ï¼Œåªèƒ½é€šè¿‡åœ¨å®¢æˆ·ç«¯ä½¿ç”¨åƒä¸€è‡´æ€§å“ˆå¸Œè¿™æ ·çš„åˆ†å¸ƒå¼ç®—æ³•æ¥å®ç°åˆ†å¸ƒå¼å­˜å‚¨ï¼Œè¿™ç§æ–¹å¼åœ¨å­˜å‚¨å’ŒæŸ¥è¯¢æ—¶éƒ½éœ€è¦å…ˆåœ¨å®¢æˆ·ç«¯è®¡ç®—ä¸€æ¬¡æ•°æ®æ‰€åœ¨çš„èŠ‚ç‚¹ã€‚")]),t._v(" "),s("li",[t._v("Redis Cluster å®ç°äº†åˆ†å¸ƒå¼çš„æ”¯æŒã€‚")])]),t._v(" "),s("p",[s("strong",[t._v("å†…å­˜ç®¡ç†æœºåˆ¶")])]),t._v(" "),s("ul",[s("li",[t._v("Memcached å°†å†…å­˜åˆ†å‰²æˆç‰¹å®šé•¿åº¦çš„å—æ¥å­˜å‚¨æ•°æ®ï¼Œä»¥å®Œå…¨è§£å†³å†…å­˜ç¢ç‰‡çš„é—®é¢˜ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼ä¼šä½¿å¾—å†…å­˜çš„åˆ©ç”¨ç‡ä¸é«˜ï¼Œä¾‹å¦‚å—çš„å¤§å°ä¸º 128 bytesï¼Œåªå­˜å‚¨ 100 bytes çš„æ•°æ®ï¼Œé‚£ä¹ˆå‰©ä¸‹çš„ 28 bytes å°±æµªè´¹æ‰äº†ã€‚")]),t._v(" "),s("li",[t._v("åœ¨ Redis ä¸­ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰æ•°æ®éƒ½ä¸€ç›´å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¯ä»¥å°†ä¸€äº›å¾ˆä¹…æ²¡ç”¨çš„ value äº¤æ¢åˆ°ç£ç›˜ã€‚è€Œ Memcached çš„æ•°æ®åˆ™ä¼šä¸€ç›´åœ¨å†…å­˜ä¸­ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"redis-ä¸ºä»€ä¹ˆå¿«"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#redis-ä¸ºä»€ä¹ˆå¿«"}},[t._v("#")]),t._v(" Redis ä¸ºä»€ä¹ˆå¿«")]),t._v(" "),s("p",[t._v("Redis å•æœº QPS èƒ½è¾¾åˆ° 100000ã€‚")]),t._v(" "),s("p",[t._v("Redis æ˜¯å•çº¿ç¨‹æ¨¡å‹ï¼ˆRedis 6.0 å·²ç»æ”¯æŒå¤šçº¿ç¨‹æ¨¡å‹ï¼‰ï¼Œä¸ºä»€ä¹ˆè¿˜èƒ½æœ‰è¿™ä¹ˆé«˜çš„å¹¶å‘ï¼Ÿ")]),t._v(" "),s("ul",[s("li",[t._v("Redis å®Œå…¨åŸºäºå†…å­˜æ“ä½œã€‚")]),t._v(" "),s("li",[t._v("Redis æ•°æ®ç»“æ„ç®€å•ã€‚")]),t._v(" "),s("li",[t._v("é‡‡ç”¨å•çº¿ç¨‹ï¼Œé¿å…çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç«äº‰ã€‚")]),t._v(" "),s("li",[t._v("ä½¿ç”¨ I/O å¤šè·¯å¤ç”¨æ¨¡å‹ï¼ˆéé˜»å¡ I/Oï¼‰ã€‚")])]),t._v(" "),s("blockquote",[s("p",[t._v("I/O å¤šè·¯å¤ç”¨")]),t._v(" "),s("p",[t._v("I/O å¤šè·¯å¤ç”¨æ¨¡å‹æ˜¯åˆ©ç”¨ selectã€pollã€epoll å¯ä»¥åŒæ—¶ç›‘å¯Ÿå¤šä¸ªæµçš„ I/O äº‹ä»¶çš„èƒ½åŠ›ï¼Œåœ¨ç©ºé—²çš„æ—¶å€™ï¼Œä¼šæŠŠå½“å‰çº¿ç¨‹é˜»å¡æ‰ï¼Œå½“æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªæµæœ‰ I/O äº‹ä»¶æ—¶ï¼Œå°±ä»é˜»å¡æ€ä¸­å”¤é†’ï¼Œäºæ˜¯ç¨‹åºå°±ä¼šè½®è¯¢ä¸€éæ‰€æœ‰çš„æµï¼ˆepoll æ˜¯åªè½®è¯¢é‚£äº›çœŸæ­£å‘å‡ºäº†äº‹ä»¶çš„æµï¼‰ï¼Œå¹¶ä¸”åªä¾æ¬¡é¡ºåºçš„å¤„ç†å°±ç»ªçš„æµï¼Œè¿™ç§åšæ³•å°±é¿å…äº†å¤§é‡çš„æ— ç”¨æ“ä½œã€‚")])]),t._v(" "),s("h2",{attrs:{id:"äºŒã€redis-æ•°æ®ç±»å‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#äºŒã€redis-æ•°æ®ç±»å‹"}},[t._v("#")]),t._v(" äºŒã€Redis æ•°æ®ç±»å‹")]),t._v(" "),s("p",[t._v("Redis åŸºæœ¬æ•°æ®ç±»å‹ï¼šSTRINGã€HASHã€LISTã€SETã€ZSET")]),t._v(" "),s("p",[t._v("Redis é«˜çº§æ•°æ®ç±»å‹ï¼šBitMapã€HyperLogLogã€GEO")]),t._v(" "),s("blockquote",[s("p",[t._v("ğŸ’¡ æ›´è¯¦ç»†çš„ç‰¹æ€§åŠåŸç†è¯´æ˜è¯·å‚è€ƒï¼š"),s("RouterLink",{attrs:{to:"/12.æ•°æ®åº“/05.KVæ•°æ®åº“/01.Redis/03.Redisæ•°æ®ç±»å‹å’Œåº”ç”¨.html"}},[t._v("Redis æ•°æ®ç±»å‹å’Œåº”ç”¨")])],1)]),t._v(" "),s("h2",{attrs:{id:"ä¸‰ã€redis-å†…å­˜æ·˜æ±°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸‰ã€redis-å†…å­˜æ·˜æ±°"}},[t._v("#")]),t._v(" ä¸‰ã€Redis å†…å­˜æ·˜æ±°")]),t._v(" "),s("h3",{attrs:{id:"å†…å­˜æ·˜æ±°è¦ç‚¹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å†…å­˜æ·˜æ±°è¦ç‚¹"}},[t._v("#")]),t._v(" å†…å­˜æ·˜æ±°è¦ç‚¹")]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("æœ€å¤§ç¼“å­˜")]),t._v(" - Redis å…è®¸é€šè¿‡ "),s("code",[t._v("maxmemory")]),t._v(" å‚æ•°æ¥è®¾ç½®å†…å­˜æœ€å¤§å€¼ã€‚")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("å¤±æ•ˆæ—¶é—´")]),t._v(" - ä½œä¸ºä¸€ç§å®šæœŸæ¸…ç†æ— æ•ˆæ•°æ®çš„é‡è¦æœºåˆ¶ï¼Œåœ¨ Redis æä¾›çš„è¯¸å¤šå‘½ä»¤ä¸­ï¼Œ"),s("code",[t._v("EXPIRE")]),t._v("ã€"),s("code",[t._v("EXPIREAT")]),t._v("ã€"),s("code",[t._v("PEXPIRE")]),t._v("ã€"),s("code",[t._v("PEXPIREAT")]),t._v(" ä»¥åŠ "),s("code",[t._v("SETEX")]),t._v(" å’Œ "),s("code",[t._v("PSETEX")]),t._v(" å‡å¯ä»¥ç”¨æ¥è®¾ç½®ä¸€æ¡é”®å€¼å¯¹çš„å¤±æ•ˆæ—¶é—´ã€‚è€Œä¸€æ¡é”®å€¼å¯¹ä¸€æ—¦è¢«å…³è”äº†å¤±æ•ˆæ—¶é—´å°±ä¼šåœ¨åˆ°æœŸåè‡ªåŠ¨åˆ é™¤ï¼ˆæˆ–è€…è¯´å˜å¾—æ— æ³•è®¿é—®æ›´ä¸ºå‡†ç¡®ï¼‰ã€‚")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("æ·˜æ±°ç­–ç•¥")]),t._v(" - éšç€ä¸æ–­çš„å‘ Redis ä¸­ä¿å­˜æ•°æ®ï¼Œå½“å†…å­˜å‰©ä½™ç©ºé—´æ— æ³•æ»¡è¶³æ·»åŠ çš„æ•°æ®æ—¶ï¼ŒRedis å†…å°±ä¼šæ–½è¡Œæ•°æ®æ·˜æ±°ç­–ç•¥ï¼Œæ¸…é™¤ä¸€éƒ¨åˆ†å†…å®¹ç„¶åä¿è¯æ–°çš„æ•°æ®å¯ä»¥ä¿å­˜åˆ°å†…å­˜ä¸­ã€‚å†…å­˜æ·˜æ±°æœºåˆ¶æ˜¯ä¸ºäº†æ›´å¥½çš„ä½¿ç”¨å†…å­˜ï¼Œç”¨ä¸€å®šå¾— miss æ¥æ¢å–å†…å­˜çš„åˆ©ç”¨ç‡ï¼Œä¿è¯ Redis ç¼“å­˜ä¸­ä¿å­˜çš„éƒ½æ˜¯çƒ­ç‚¹æ•°æ®ã€‚")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("éç²¾å‡†çš„ LRU")]),t._v(" - å®é™…ä¸Š Redis å®ç°çš„ LRU å¹¶ä¸æ˜¯å¯é çš„ LRUï¼Œä¹Ÿå°±æ˜¯åä¹‰ä¸Šæˆ‘ä»¬ä½¿ç”¨ LRU ç®—æ³•æ·˜æ±°é”®ï¼Œä½†æ˜¯å®é™…ä¸Šè¢«æ·˜æ±°çš„é”®å¹¶ä¸ä¸€å®šæ˜¯çœŸæ­£çš„æœ€ä¹…æ²¡ç”¨çš„ã€‚")])])]),t._v(" "),s("h3",{attrs:{id:"ä¸»é”®è¿‡æœŸæ—¶é—´"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸»é”®è¿‡æœŸæ—¶é—´"}},[t._v("#")]),t._v(" ä¸»é”®è¿‡æœŸæ—¶é—´")]),t._v(" "),s("p",[t._v("Redis å¯ä»¥ä¸ºæ¯ä¸ªé”®è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå½“é”®è¿‡æœŸæ—¶ï¼Œä¼šè‡ªåŠ¨åˆ é™¤è¯¥é”®ã€‚")]),t._v(" "),s("p",[t._v("å¯¹äºæ•£åˆ—è¡¨è¿™ç§å®¹å™¨ï¼Œåªèƒ½ä¸ºæ•´ä¸ªé”®è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆæ•´ä¸ªæ•£åˆ—è¡¨ï¼‰ï¼Œè€Œä¸èƒ½ä¸ºé”®é‡Œé¢çš„å•ä¸ªå…ƒç´ è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚")]),t._v(" "),s("p",[t._v("å¯ä»¥ä½¿ç”¨ "),s("code",[t._v("EXPIRE")]),t._v(" æˆ– "),s("code",[t._v("EXPIREAT")]),t._v(" æ¥ä¸º key è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚")]),t._v(" "),s("blockquote",[s("p",[t._v("ğŸ”” æ³¨æ„ï¼šå½“ "),s("code",[t._v("EXPIRE")]),t._v(" çš„æ—¶é—´å¦‚æœè®¾ç½®çš„æ˜¯è´Ÿæ•°ï¼Œ"),s("code",[t._v("EXPIREAT")]),t._v(" è®¾ç½®çš„æ—¶é—´æˆ³æ˜¯è¿‡æœŸæ—¶é—´ï¼Œå°†ç›´æ¥åˆ é™¤ keyã€‚")])]),t._v(" "),s("p",[t._v("ç¤ºä¾‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("redis"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" SET mykey "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"OK"')]),t._v("\nredis"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" EXPIRE mykey "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nredis"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" TTL mykey\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\nredis"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" SET mykey "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello World"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"OK"')]),t._v("\nredis"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" TTL mykey\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-1")]),t._v("\nredis"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("h3",{attrs:{id:"æ·˜æ±°ç­–ç•¥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ·˜æ±°ç­–ç•¥"}},[t._v("#")]),t._v(" æ·˜æ±°ç­–ç•¥")]),t._v(" "),s("p",[t._v("å†…å­˜æ·˜æ±°åªæ˜¯ Redis æä¾›çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œä¸ºäº†æ›´å¥½åœ°å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œå¿…é¡»ä¸ºä¸åŒçš„åº”ç”¨åœºæ™¯æä¾›ä¸åŒçš„ç­–ç•¥ï¼Œå†…å­˜æ·˜æ±°ç­–ç•¥è®²çš„æ˜¯ä¸ºå®ç°å†…å­˜æ·˜æ±°æˆ‘ä»¬å…·ä½“æ€ä¹ˆåšï¼Œè¦è§£å†³çš„é—®é¢˜åŒ…æ‹¬æ·˜æ±°é”®ç©ºé—´å¦‚ä½•é€‰æ‹©ï¼Ÿåœ¨é”®ç©ºé—´ä¸­æ·˜æ±°é”®å¦‚ä½•é€‰æ‹©ï¼Ÿ")]),t._v(" "),s("p",[t._v("Redis æä¾›äº†ä¸‹é¢å‡ ç§å†…å­˜æ·˜æ±°ç­–ç•¥ä¾›ç”¨æˆ·é€‰ï¼š")]),t._v(" "),s("ul",[s("li",[s("strong",[s("code",[t._v("noeviction")])]),t._v(" - å½“å†…å­˜ä½¿ç”¨è¾¾åˆ°é˜ˆå€¼çš„æ—¶å€™ï¼Œæ‰€æœ‰å¼•èµ·ç”³è¯·å†…å­˜çš„å‘½ä»¤ä¼šæŠ¥é”™ã€‚è¿™æ˜¯ Redis é»˜è®¤çš„ç­–ç•¥ã€‚")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("allkeys-lru")])]),t._v(" - åœ¨ä¸»é”®ç©ºé—´ä¸­ï¼Œä¼˜å…ˆç§»é™¤æœ€è¿‘æœªä½¿ç”¨çš„ keyã€‚")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("allkeys-random")])]),t._v(" - åœ¨ä¸»é”®ç©ºé—´ä¸­ï¼Œéšæœºç§»é™¤æŸä¸ª keyã€‚")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("volatile-lru")])]),t._v(" - åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œä¼˜å…ˆç§»é™¤æœ€è¿‘æœªä½¿ç”¨çš„ keyã€‚")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("volatile-random")])]),t._v(" - åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œéšæœºç§»é™¤æŸä¸ª keyã€‚")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("volatile-ttl")])]),t._v(" - åœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œå…·æœ‰æ›´æ—©è¿‡æœŸæ—¶é—´çš„ key ä¼˜å…ˆç§»é™¤ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"å¦‚ä½•é€‰æ‹©æ·˜æ±°ç­–ç•¥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¦‚ä½•é€‰æ‹©æ·˜æ±°ç­–ç•¥"}},[t._v("#")]),t._v(" å¦‚ä½•é€‰æ‹©æ·˜æ±°ç­–ç•¥")]),t._v(" "),s("ul",[s("li",[t._v("å¦‚æœ"),s("strong",[t._v("æ•°æ®å‘ˆç°å¹‚ç­‰åˆ†å¸ƒï¼ˆå­˜åœ¨çƒ­ç‚¹æ•°æ®ï¼Œéƒ¨åˆ†æ•°æ®è®¿é—®é¢‘ç‡é«˜ï¼Œéƒ¨åˆ†æ•°æ®è®¿é—®é¢‘ç‡ä½ï¼‰ï¼Œåˆ™ä½¿ç”¨ "),s("code",[t._v("allkeys-lru")])]),t._v("ã€‚")]),t._v(" "),s("li",[t._v("å¦‚æœ"),s("strong",[t._v("æ•°æ®å‘ˆç°å¹³ç­‰åˆ†å¸ƒï¼ˆæ•°æ®è®¿é—®é¢‘ç‡å¤§è‡´ç›¸åŒï¼‰ï¼Œåˆ™ä½¿ç”¨ "),s("code",[t._v("allkeys-random")])]),t._v("ã€‚")]),t._v(" "),s("li",[t._v("å¦‚æœå¸Œæœ›"),s("strong",[t._v("ä½¿ç”¨ä¸åŒçš„ TTL å€¼å‘ Redis æç¤ºå“ªäº› key æ›´é€‚åˆè¢«æ·˜æ±°ï¼Œè¯·ä½¿ç”¨ "),s("code",[t._v("volatile-ttl")])]),t._v("ã€‚")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("volatile-lru")]),t._v(" å’Œ "),s("code",[t._v("volatile-random")]),t._v(" é€‚åˆæ—¢åº”ç”¨äºç¼“å­˜å’Œåˆåº”ç”¨äºæŒä¹…åŒ–å­˜å‚¨çš„åœºæ™¯")]),t._v("ï¼Œç„¶è€Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨ä¸¤ä¸ª Redis å®ä¾‹æ¥è¾¾åˆ°ç›¸åŒçš„æ•ˆæœã€‚")]),t._v(" "),s("li",[s("strong",[t._v("å°† key è®¾ç½®è¿‡æœŸæ—¶é—´å®é™…ä¸Šä¼šæ¶ˆè€—æ›´å¤šçš„å†…å­˜ï¼Œå› æ­¤å»ºè®®ä½¿ç”¨ "),s("code",[t._v("allkeys-lru")]),t._v(" ç­–ç•¥ä»è€Œæ›´æœ‰æ•ˆç‡çš„ä½¿ç”¨å†…å­˜")]),t._v("ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"å†…éƒ¨å®ç°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å†…éƒ¨å®ç°"}},[t._v("#")]),t._v(" å†…éƒ¨å®ç°")]),t._v(" "),s("p",[t._v("Redis åˆ é™¤å¤±æ•ˆä¸»é”®çš„æ–¹æ³•ä¸»è¦æœ‰ä¸¤ç§ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("æ¶ˆææ–¹æ³•ï¼ˆpassive wayï¼‰ï¼Œåœ¨ä¸»é”®è¢«è®¿é—®æ—¶å¦‚æœå‘ç°å®ƒå·²ç»å¤±æ•ˆï¼Œé‚£ä¹ˆå°±åˆ é™¤å®ƒã€‚")]),t._v(" "),s("li",[t._v("ä¸»åŠ¨æ–¹æ³•ï¼ˆactive wayï¼‰ï¼Œå‘¨æœŸæ€§åœ°ä»è®¾ç½®äº†å¤±æ•ˆæ—¶é—´çš„ä¸»é”®ä¸­é€‰æ‹©ä¸€éƒ¨åˆ†å¤±æ•ˆçš„ä¸»é”®åˆ é™¤ã€‚")]),t._v(" "),s("li",[t._v("ä¸»åŠ¨åˆ é™¤ï¼šå½“å‰å·²ç”¨å†…å­˜è¶…è¿‡ "),s("code",[t._v("maxmemory")]),t._v(" é™å®šæ—¶ï¼Œè§¦å‘ä¸»åŠ¨æ¸…ç†ç­–ç•¥ï¼Œè¯¥ç­–ç•¥ç”±å¯åŠ¨å‚æ•°çš„é…ç½®å†³å®šä¸»é”®å…·ä½“çš„å¤±æ•ˆæ—¶é—´å…¨éƒ¨éƒ½ç»´æŠ¤åœ¨ "),s("code",[t._v("expires")]),t._v(" è¿™ä¸ªå­—å…¸è¡¨ä¸­ã€‚")])]),t._v(" "),s("h2",{attrs:{id:"å››ã€redis-æŒä¹…åŒ–"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å››ã€redis-æŒä¹…åŒ–"}},[t._v("#")]),t._v(" å››ã€Redis æŒä¹…åŒ–")]),t._v(" "),s("p",[t._v("Redis æ˜¯å†…å­˜å‹æ•°æ®åº“ï¼Œä¸ºäº†ä¿è¯æ•°æ®åœ¨å®•æœºåä¸ä¼šä¸¢å¤±ï¼Œéœ€è¦å°†å†…å­˜ä¸­çš„æ•°æ®æŒä¹…åŒ–åˆ°ç¡¬ç›˜ä¸Šã€‚")]),t._v(" "),s("p",[t._v("Redis æ”¯æŒä¸¤ç§æŒä¹…åŒ–æ–¹å¼ï¼šRDB å’Œ AOFã€‚")]),t._v(" "),s("ul",[s("li",[t._v("RDB - "),s("strong",[t._v("RDB å³å¿«ç…§æ–¹å¼ï¼Œå®ƒå°†æŸä¸ªæ—¶é—´ç‚¹çš„æ‰€æœ‰ Redis æ•°æ®ä¿å­˜åˆ°ä¸€ä¸ªç»è¿‡å‹ç¼©çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆRDB æ–‡ä»¶ï¼‰ä¸­")]),t._v("ã€‚")]),t._v(" "),s("li",[t._v("AOF - "),s("code",[t._v("AOF(Append Only File)")]),t._v(" æ˜¯ä»¥æ–‡æœ¬æ—¥å¿—å½¢å¼å°†æ‰€æœ‰å†™å‘½ä»¤è¿½åŠ åˆ° AOF æ–‡ä»¶çš„æœ«å°¾ï¼Œä»¥æ­¤æ¥è®°å½•æ•°æ®çš„å˜åŒ–ã€‚å½“æœåŠ¡å™¨é‡å¯çš„æ—¶å€™ä¼šé‡æ–°è½½å…¥å’Œæ‰§è¡Œè¿™äº›å‘½ä»¤æ¥æ¢å¤åŸå§‹çš„æ•°æ®ã€‚AOF é€‚åˆä½œä¸º "),s("strong",[t._v("çƒ­å¤‡")]),t._v("ã€‚")])]),t._v(" "),s("blockquote",[s("p",[t._v("ğŸ’¡ æ›´è¯¦ç»†çš„ç‰¹æ€§åŠåŸç†è¯´æ˜è¯·å‚è€ƒï¼š"),s("RouterLink",{attrs:{to:"/12.æ•°æ®åº“/05.KVæ•°æ®åº“/01.Redis/04.RedisæŒä¹…åŒ–.html"}},[t._v("Redis æŒä¹…åŒ–")])],1)]),t._v(" "),s("h2",{attrs:{id:"äº”ã€redis-äº‹ä»¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#äº”ã€redis-äº‹ä»¶"}},[t._v("#")]),t._v(" äº”ã€Redis äº‹ä»¶")]),t._v(" "),s("p",[t._v("Redis æœåŠ¡å™¨æ˜¯ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ç¨‹åºï¼ŒæœåŠ¡å™¨éœ€è¦å¤„ç†ä¸¤ç±»äº‹ä»¶ï¼š")]),t._v(" "),s("ul",[s("li",[s("strong",[s("code",[t._v("æ–‡ä»¶äº‹ä»¶ï¼ˆfile eventï¼‰")])]),t._v(" - Redis æœåŠ¡å™¨é€šè¿‡å¥—æ¥å­—ï¼ˆSocketï¼‰ä¸å®¢æˆ·ç«¯æˆ–è€…å…¶å®ƒæœåŠ¡å™¨è¿›è¡Œé€šä¿¡ï¼Œæ–‡ä»¶äº‹ä»¶å°±æ˜¯å¯¹å¥—æ¥å­—æ“ä½œçš„æŠ½è±¡ã€‚æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯ï¼ˆæˆ–å…¶ä»–çš„æœåŠ¡å™¨ï¼‰çš„é€šä¿¡ä¼šäº§ç”Ÿæ–‡ä»¶äº‹ä»¶ï¼Œè€ŒæœåŠ¡å™¨é€šè¿‡ç›‘å¬å¹¶å¤„ç†è¿™äº›äº‹ä»¶æ¥å®Œæˆä¸€ç³»åˆ—ç½‘ç»œé€šä¿¡æ“ä½œã€‚")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("æ—¶é—´äº‹ä»¶ï¼ˆtime eventï¼‰")])]),t._v(" - Redis æœåŠ¡å™¨æœ‰ä¸€äº›æ“ä½œéœ€è¦åœ¨ç»™å®šçš„æ—¶é—´ç‚¹æ‰§è¡Œï¼Œæ—¶é—´äº‹ä»¶æ˜¯å¯¹è¿™ç±»å®šæ—¶æ“ä½œçš„æŠ½è±¡ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"æ–‡ä»¶äº‹ä»¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ–‡ä»¶äº‹ä»¶"}},[t._v("#")]),t._v(" æ–‡ä»¶äº‹ä»¶")]),t._v(" "),s("p",[t._v("Redis åŸºäº Reactor æ¨¡å¼å¼€å‘äº†è‡ªå·±çš„ç½‘ç»œæ—¶é—´å¤„ç†å™¨ã€‚")]),t._v(" "),s("ul",[s("li",[t._v("Redis æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨ä½¿ç”¨ I/O å¤šè·¯å¤ç”¨ç¨‹åºæ¥åŒæ—¶ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œå¹¶æ ¹æ®å¥—æ¥å­—ç›®å‰æ‰§è¡Œçš„ä»»åŠ¡æ¥ä¸ºå¥—æ¥å­—å…³è”ä¸åŒçš„äº‹ä»¶å¤„ç†å™¨ã€‚")]),t._v(" "),s("li",[t._v("å½“è¢«ç›‘å¬çš„å¥—æ¥å­—å‡†å¤‡å¥½æ‰§è¡Œè¿æ¥åº”ç­”ã€è¯»å–ã€å†™å…¥ã€å…³é—­æ“ä½œæ—¶ï¼Œä¸æ“ä½œç›¸å¯¹åº”çš„æ–‡ä»¶äº‹ä»¶å°±ä¼šäº§ç”Ÿï¼Œè¿™æ—¶æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨å°±ä¼šè°ƒç”¨å¥—æ¥å­—ä¹‹å‰å…³è”å¥½çš„äº‹ä»¶å¤„ç†å™¨æ¥å¤„ç†è¿™äº›äº‹ä»¶ã€‚")])]),t._v(" "),s("p",[t._v("è™½ç„¶æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨ä»¥å•çº¿ç¨‹æ–¹å¼è¿è¡Œï¼Œä½†é€šè¿‡ä½¿ç”¨ I/O å¤šè·¯å¤ç”¨ç¨‹åºæ¥ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œæ–‡ä»¶äº‹ä»¶å¤„ç†å™¨å®ç°äº†é«˜æ€§èƒ½çš„ç½‘ç»œé€šä¿¡æ¨¡å‹ã€‚")]),t._v(" "),s("p",[t._v("æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨æœ‰å››ä¸ªç»„æˆéƒ¨åˆ†ï¼šå¥—æ¥å­—ã€I/O å¤šè·¯å¤ç”¨ç¨‹åºã€æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ã€äº‹ä»¶å¤„ç†å™¨ã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/master/snap/20200130172525.png",alt:"img"}})]),t._v(" "),s("h3",{attrs:{id:"æ—¶é—´äº‹ä»¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ—¶é—´äº‹ä»¶"}},[t._v("#")]),t._v(" æ—¶é—´äº‹ä»¶")]),t._v(" "),s("p",[t._v("æ—¶é—´äº‹ä»¶åˆåˆ†ä¸ºï¼š")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("å®šæ—¶äº‹ä»¶")]),t._v("ï¼šæ˜¯è®©ä¸€æ®µç¨‹åºåœ¨æŒ‡å®šçš„æ—¶é—´ä¹‹å†…æ‰§è¡Œä¸€æ¬¡ï¼›")]),t._v(" "),s("li",[s("strong",[t._v("å‘¨æœŸæ€§äº‹ä»¶")]),t._v("ï¼šæ˜¯è®©ä¸€æ®µç¨‹åºæ¯éš”æŒ‡å®šæ—¶é—´å°±æ‰§è¡Œä¸€æ¬¡ã€‚")])]),t._v(" "),s("p",[t._v("Redis å°†æ‰€æœ‰æ—¶é—´äº‹ä»¶éƒ½æ”¾åœ¨ä¸€ä¸ªæ— åºé“¾è¡¨ä¸­ï¼Œæ¯å½“æ—¶é—´äº‹ä»¶æ‰§è¡Œå™¨è¿è¡Œæ—¶ï¼Œé€šè¿‡éå†æ•´ä¸ªé“¾è¡¨æŸ¥æ‰¾å‡ºå·²åˆ°è¾¾çš„æ—¶é—´äº‹ä»¶ï¼Œå¹¶è°ƒç”¨å“åº”çš„äº‹ä»¶å¤„ç†å™¨ã€‚")]),t._v(" "),s("h3",{attrs:{id:"äº‹ä»¶çš„è°ƒåº¦ä¸æ‰§è¡Œ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#äº‹ä»¶çš„è°ƒåº¦ä¸æ‰§è¡Œ"}},[t._v("#")]),t._v(" äº‹ä»¶çš„è°ƒåº¦ä¸æ‰§è¡Œ")]),t._v(" "),s("p",[t._v("æœåŠ¡å™¨éœ€è¦ä¸æ–­ç›‘å¬æ–‡ä»¶äº‹ä»¶çš„å¥—æ¥å­—æ‰èƒ½å¾—åˆ°å¾…å¤„ç†çš„æ–‡ä»¶äº‹ä»¶ï¼Œä½†æ˜¯ä¸èƒ½ä¸€ç›´ç›‘å¬ï¼Œå¦åˆ™æ—¶é—´äº‹ä»¶æ— æ³•åœ¨è§„å®šçš„æ—¶é—´å†…æ‰§è¡Œï¼Œå› æ­¤ç›‘å¬æ—¶é—´åº”è¯¥æ ¹æ®è·ç¦»ç°åœ¨æœ€è¿‘çš„æ—¶é—´äº‹ä»¶æ¥å†³å®šã€‚")]),t._v(" "),s("p",[t._v("äº‹ä»¶è°ƒåº¦ä¸æ‰§è¡Œç”± aeProcessEvents å‡½æ•°è´Ÿè´£ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("aeProcessEvents")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## è·å–åˆ°è¾¾æ—¶é—´ç¦»å½“å‰æ—¶é—´æœ€æ¥è¿‘çš„æ—¶é—´äº‹ä»¶")]),t._v("\n    time_event "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" aeSearchNearestTimer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## è®¡ç®—æœ€æ¥è¿‘çš„æ—¶é—´äº‹ä»¶è·ç¦»åˆ°è¾¾è¿˜æœ‰å¤šå°‘æ¯«ç§’")]),t._v("\n    remaind_ms "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" time_event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("when "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" unix_ts_now"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## å¦‚æœäº‹ä»¶å·²åˆ°è¾¾ï¼Œé‚£ä¹ˆ remaind_ms çš„å€¼å¯èƒ½ä¸ºè´Ÿæ•°ï¼Œå°†å®ƒè®¾ä¸º 0")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" remaind_ms "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        remaind_ms "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## æ ¹æ® remaind_ms çš„å€¼ï¼Œåˆ›å»º timeval")]),t._v("\n    timeval "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" create_timeval_with_ms"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("remaind_ms"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## é˜»å¡å¹¶ç­‰å¾…æ–‡ä»¶äº‹ä»¶äº§ç”Ÿï¼Œæœ€å¤§é˜»å¡æ—¶é—´ç”±ä¼ å…¥çš„ timeval å†³å®š")]),t._v("\n    aeApiPoll"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("timeval"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## å¤„ç†æ‰€æœ‰å·²äº§ç”Ÿçš„æ–‡ä»¶äº‹ä»¶")]),t._v("\n    procesFileEvents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## å¤„ç†æ‰€æœ‰å·²åˆ°è¾¾çš„æ—¶é—´äº‹ä»¶")]),t._v("\n    processTimeEvents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("å°† aeProcessEvents å‡½æ•°ç½®äºä¸€ä¸ªå¾ªç¯é‡Œé¢ï¼ŒåŠ ä¸Šåˆå§‹åŒ–å’Œæ¸…ç†å‡½æ•°ï¼Œå°±æ„æˆäº† Redis æœåŠ¡å™¨çš„ä¸»å‡½æ•°ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## åˆå§‹åŒ–æœåŠ¡å™¨")]),t._v("\n    init_server"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## ä¸€ç›´å¤„ç†äº‹ä»¶ï¼Œç›´åˆ°æœåŠ¡å™¨å…³é—­ä¸ºæ­¢")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" server_is_not_shutdown"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        aeProcessEvents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## æœåŠ¡å™¨å…³é—­ï¼Œæ‰§è¡Œæ¸…ç†æ“ä½œ")]),t._v("\n    clean_server"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("ä»äº‹ä»¶å¤„ç†çš„è§’åº¦æ¥çœ‹ï¼ŒæœåŠ¡å™¨è¿è¡Œæµç¨‹å¦‚ä¸‹ï¼š")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/master/cs/database/redis/redis-event.png"}})]),t._v(" "),s("h2",{attrs:{id:"å…­ã€redis-äº‹åŠ¡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å…­ã€redis-äº‹åŠ¡"}},[t._v("#")]),t._v(" å…­ã€Redis äº‹åŠ¡")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("Redis æä¾›çš„ä¸æ˜¯ä¸¥æ ¼çš„äº‹åŠ¡ï¼ŒRedis åªä¿è¯ä¸²è¡Œæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”èƒ½ä¿è¯å…¨éƒ¨æ‰§è¡Œï¼Œä½†æ˜¯æ‰§è¡Œå‘½ä»¤å¤±è´¥æ—¶å¹¶ä¸ä¼šå›æ»šï¼Œè€Œæ˜¯ä¼šç»§ç»­æ‰§è¡Œä¸‹å»")]),t._v("ã€‚")])]),t._v(" "),s("p",[s("code",[t._v("MULTI")]),t._v(" ã€ "),s("code",[t._v("EXEC")]),t._v(" ã€ "),s("code",[t._v("DISCARD")]),t._v(" å’Œ "),s("code",[t._v("WATCH")]),t._v(" æ˜¯ Redis äº‹åŠ¡ç›¸å…³çš„å‘½ä»¤ã€‚")]),t._v(" "),s("p",[t._v("äº‹åŠ¡å¯ä»¥ä¸€æ¬¡æ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼Œ å¹¶ä¸”æœ‰ä»¥ä¸‹ä¸¤ä¸ªé‡è¦çš„ä¿è¯ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("äº‹åŠ¡æ˜¯ä¸€ä¸ªå•ç‹¬çš„éš”ç¦»æ“ä½œï¼šäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šåºåˆ—åŒ–ã€æŒ‰é¡ºåºåœ°æ‰§è¡Œã€‚äº‹åŠ¡åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘é€æ¥çš„å‘½ä»¤è¯·æ±‚æ‰€æ‰“æ–­ã€‚")]),t._v(" "),s("li",[t._v("äº‹åŠ¡æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼šäº‹åŠ¡ä¸­çš„å‘½ä»¤è¦ä¹ˆå…¨éƒ¨è¢«æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨éƒ½ä¸æ‰§è¡Œã€‚")])]),t._v(" "),s("h3",{attrs:{id:"multi"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#multi"}},[t._v("#")]),t._v(" MULTI")]),t._v(" "),s("p",[s("strong",[s("a",{attrs:{href:"https://redis.io/commands/multi",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("MULTI")]),s("OutboundLink")],1),t._v(" å‘½ä»¤ç”¨äºå¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œå®ƒæ€»æ˜¯è¿”å› OK ã€‚")])]),t._v(" "),s("p",[s("code",[t._v("MULTI")]),t._v(" æ‰§è¡Œä¹‹åï¼Œ å®¢æˆ·ç«¯å¯ä»¥ç»§ç»­å‘æœåŠ¡å™¨å‘é€ä»»æ„å¤šæ¡å‘½ä»¤ï¼Œ è¿™äº›å‘½ä»¤ä¸ä¼šç«‹å³è¢«æ‰§è¡Œï¼Œ è€Œæ˜¯è¢«æ”¾åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œ å½“ EXEC å‘½ä»¤è¢«è°ƒç”¨æ—¶ï¼Œ æ‰€æœ‰é˜Ÿåˆ—ä¸­çš„å‘½ä»¤æ‰ä¼šè¢«æ‰§è¡Œã€‚")]),t._v(" "),s("p",[t._v("ä»¥ä¸‹æ˜¯ä¸€ä¸ªäº‹åŠ¡ä¾‹å­ï¼Œ å®ƒåŸå­åœ°å¢åŠ äº† foo å’Œ bar ä¸¤ä¸ªé”®çš„å€¼ï¼š")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" MULTI\nOK\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" INCR foo\nQUEUED\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" INCR bar\nQUEUED\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" EXEC\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n")])])]),s("h3",{attrs:{id:"exec"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#exec"}},[t._v("#")]),t._v(" EXEC")]),t._v(" "),s("p",[s("strong",[s("a",{attrs:{href:"https://redis.io/commands/exec",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("EXEC")]),s("OutboundLink")],1),t._v(" å‘½ä»¤è´Ÿè´£è§¦å‘å¹¶æ‰§è¡Œäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤ã€‚")])]),t._v(" "),s("ul",[s("li",[t._v("å¦‚æœå®¢æˆ·ç«¯åœ¨ä½¿ç”¨ "),s("code",[t._v("MULTI")]),t._v(" å¼€å¯äº†ä¸€ä¸ªäº‹åŠ¡ä¹‹åï¼Œå´å› ä¸ºæ–­çº¿è€Œæ²¡æœ‰æˆåŠŸæ‰§è¡Œ "),s("code",[t._v("EXEC")]),t._v(" ï¼Œé‚£ä¹ˆäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¸ä¼šè¢«æ‰§è¡Œã€‚")]),t._v(" "),s("li",[t._v("å¦ä¸€æ–¹é¢ï¼Œå¦‚æœå®¢æˆ·ç«¯æˆåŠŸåœ¨å¼€å¯äº‹åŠ¡ä¹‹åæ‰§è¡Œ "),s("code",[t._v("EXEC")]),t._v(" ï¼Œé‚£ä¹ˆäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šè¢«æ‰§è¡Œã€‚")])]),t._v(" "),s("h3",{attrs:{id:"discard"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#discard"}},[t._v("#")]),t._v(" DISCARD")]),t._v(" "),s("p",[s("strong",[t._v("å½“æ‰§è¡Œ "),s("a",{attrs:{href:"https://redis.io/commands/discard",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("DISCARD")]),s("OutboundLink")],1),t._v(" å‘½ä»¤æ—¶ï¼Œ äº‹åŠ¡ä¼šè¢«æ”¾å¼ƒï¼Œ äº‹åŠ¡é˜Ÿåˆ—ä¼šè¢«æ¸…ç©ºï¼Œ å¹¶ä¸”å®¢æˆ·ç«¯ä¼šä»äº‹åŠ¡çŠ¶æ€ä¸­é€€å‡ºã€‚")])]),t._v(" "),s("p",[t._v("ç¤ºä¾‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" SET foo "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nOK\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" MULTI\nOK\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" INCR foo\nQUEUED\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" DISCARD\nOK\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" GET foo\n"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v("\n")])])]),s("h3",{attrs:{id:"watch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#watch"}},[t._v("#")]),t._v(" WATCH")]),t._v(" "),s("p",[s("strong",[s("a",{attrs:{href:"https://redis.io/commands/watch",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("WATCH")]),s("OutboundLink")],1),t._v(" å‘½ä»¤å¯ä»¥ä¸º Redis äº‹åŠ¡æä¾› check-and-set ï¼ˆCASï¼‰è¡Œä¸ºã€‚")])]),t._v(" "),s("p",[t._v("è¢« WATCH çš„é”®ä¼šè¢«ç›‘è§†ï¼Œå¹¶ä¼šå‘è§‰è¿™äº›é”®æ˜¯å¦è¢«æ”¹åŠ¨è¿‡äº†ã€‚ å¦‚æœæœ‰è‡³å°‘ä¸€ä¸ªè¢«ç›‘è§†çš„é”®åœ¨ EXEC æ‰§è¡Œä¹‹å‰è¢«ä¿®æ”¹äº†ï¼Œ é‚£ä¹ˆæ•´ä¸ªäº‹åŠ¡éƒ½ä¼šè¢«å–æ¶ˆï¼Œ EXEC è¿”å› nil-reply æ¥è¡¨ç¤ºäº‹åŠ¡å·²ç»å¤±è´¥ã€‚")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("WATCH mykey\nval "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GET mykey\nval "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" val "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nMULTI\nSET mykey $val\nEXEC\n")])])]),s("p",[t._v("ä½¿ç”¨ä¸Šé¢çš„ä»£ç ï¼Œ å¦‚æœåœ¨ WATCH æ‰§è¡Œä¹‹åï¼Œ EXEC æ‰§è¡Œä¹‹å‰ï¼Œ æœ‰å…¶ä»–å®¢æˆ·ç«¯ä¿®æ”¹äº† mykey çš„å€¼ï¼Œ é‚£ä¹ˆå½“å‰å®¢æˆ·ç«¯çš„äº‹åŠ¡å°±ä¼šå¤±è´¥ã€‚ ç¨‹åºéœ€è¦åšçš„ï¼Œ å°±æ˜¯ä¸æ–­é‡è¯•è¿™ä¸ªæ“ä½œï¼Œ ç›´åˆ°æ²¡æœ‰å‘ç”Ÿç¢°æ’ä¸ºæ­¢ã€‚")]),t._v(" "),s("p",[t._v("è¿™ç§å½¢å¼çš„é”è¢«ç§°ä½œä¹è§‚é”ï¼Œ å®ƒæ˜¯ä¸€ç§éå¸¸å¼ºå¤§çš„é”æœºåˆ¶ã€‚ å¹¶ä¸”å› ä¸ºå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ ä¸åŒçš„å®¢æˆ·ç«¯ä¼šè®¿é—®ä¸åŒçš„é”®ï¼Œ ç¢°æ’çš„æƒ…å†µä¸€èˆ¬éƒ½å¾ˆå°‘ï¼Œ æ‰€ä»¥é€šå¸¸å¹¶ä¸éœ€è¦è¿›è¡Œé‡è¯•ã€‚")]),t._v(" "),s("p",[t._v("WATCH ä½¿å¾— EXEC å‘½ä»¤éœ€è¦æœ‰æ¡ä»¶åœ°æ‰§è¡Œï¼šäº‹åŠ¡åªèƒ½åœ¨æ‰€æœ‰è¢«ç›‘è§†é”®éƒ½æ²¡æœ‰è¢«ä¿®æ”¹çš„å‰æä¸‹æ‰§è¡Œï¼Œå¦‚æœè¿™ä¸ªå‰æä¸èƒ½æ»¡è¶³çš„è¯ï¼Œäº‹åŠ¡å°±ä¸ä¼šè¢«æ‰§è¡Œã€‚")]),t._v(" "),s("p",[t._v("WATCH å‘½ä»¤å¯ä»¥è¢«è°ƒç”¨å¤šæ¬¡ã€‚å¯¹é”®çš„ç›‘è§†ä» WATCH æ‰§è¡Œä¹‹åå¼€å§‹ç”Ÿæ•ˆï¼Œç›´åˆ°è°ƒç”¨ EXEC ä¸ºæ­¢ã€‚")]),t._v(" "),s("p",[t._v("ç”¨æˆ·è¿˜å¯ä»¥åœ¨å•ä¸ª WATCH å‘½ä»¤ä¸­ç›‘è§†ä»»æ„å¤šä¸ªé”®ï¼Œä¾‹å¦‚ï¼š")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("redis"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" WATCH key1 key2 key3\nOK\n")])])]),s("h4",{attrs:{id:"å–æ¶ˆ-watch-çš„åœºæ™¯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å–æ¶ˆ-watch-çš„åœºæ™¯"}},[t._v("#")]),t._v(" å–æ¶ˆ WATCH çš„åœºæ™¯")]),t._v(" "),s("p",[t._v("å½“ EXEC è¢«è°ƒç”¨æ—¶ï¼Œ ä¸ç®¡äº‹åŠ¡æ˜¯å¦æˆåŠŸæ‰§è¡Œï¼Œ å¯¹æ‰€æœ‰é”®çš„ç›‘è§†éƒ½ä¼šè¢«å–æ¶ˆã€‚")]),t._v(" "),s("p",[t._v("å¦å¤–ï¼Œ å½“å®¢æˆ·ç«¯æ–­å¼€è¿æ¥æ—¶ï¼Œ è¯¥å®¢æˆ·ç«¯å¯¹é”®çš„ç›‘è§†ä¹Ÿä¼šè¢«å–æ¶ˆã€‚")]),t._v(" "),s("p",[t._v("ä½¿ç”¨æ— å‚æ•°çš„ UNWATCH å‘½ä»¤å¯ä»¥æ‰‹åŠ¨å–æ¶ˆå¯¹æ‰€æœ‰é”®çš„ç›‘è§†ã€‚ å¯¹äºä¸€äº›éœ€è¦æ”¹åŠ¨å¤šä¸ªé”®çš„äº‹åŠ¡ï¼Œ æœ‰æ—¶å€™ç¨‹åºéœ€è¦åŒæ—¶å¯¹å¤šä¸ªé”®è¿›è¡ŒåŠ é”ï¼Œ ç„¶åæ£€æŸ¥è¿™äº›é”®çš„å½“å‰å€¼æ˜¯å¦ç¬¦åˆç¨‹åºçš„è¦æ±‚ã€‚ å½“å€¼è¾¾ä¸åˆ°è¦æ±‚æ—¶ï¼Œ å°±å¯ä»¥ä½¿ç”¨ UNWATCH å‘½ä»¤æ¥å–æ¶ˆç›®å‰å¯¹é”®çš„ç›‘è§†ï¼Œ ä¸­é€”æ”¾å¼ƒè¿™ä¸ªäº‹åŠ¡ï¼Œ å¹¶ç­‰å¾…äº‹åŠ¡çš„ä¸‹æ¬¡å°è¯•ã€‚")]),t._v(" "),s("h4",{attrs:{id:"ä½¿ç”¨-watch-åˆ›å»ºåŸå­æ“ä½œ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨-watch-åˆ›å»ºåŸå­æ“ä½œ"}},[t._v("#")]),t._v(" ä½¿ç”¨ WATCH åˆ›å»ºåŸå­æ“ä½œ")]),t._v(" "),s("p",[t._v("WATCH å¯ä»¥ç”¨äºåˆ›å»º Redis æ²¡æœ‰å†…ç½®çš„åŸå­æ“ä½œã€‚")]),t._v(" "),s("p",[t._v("ä¸¾ä¸ªä¾‹å­ï¼Œä»¥ä¸‹ä»£ç å®ç°äº†åŸåˆ›çš„ ZPOP å‘½ä»¤ï¼Œå®ƒå¯ä»¥åŸå­åœ°å¼¹å‡ºæœ‰åºé›†åˆä¸­åˆ†å€¼ï¼ˆscoreï¼‰æœ€å°çš„å…ƒç´ ï¼š")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("WATCH zset\nelement = ZRANGE zset 0 0\nMULTI\nZREM zset element\nEXEC\n")])])]),s("h3",{attrs:{id:"rollback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rollback"}},[t._v("#")]),t._v(" Rollback")]),t._v(" "),s("p",[s("strong",[t._v("Redis ä¸æ”¯æŒå›æ»š")]),t._v("ã€‚Redis ä¸æ”¯æŒå›æ»šçš„ç†ç”±ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("Redis å‘½ä»¤åªä¼šå› ä¸ºé”™è¯¯çš„è¯­æ³•è€Œå¤±è´¥ï¼Œæˆ–æ˜¯å‘½ä»¤ç”¨åœ¨äº†é”™è¯¯ç±»å‹çš„é”®ä¸Šé¢ã€‚")]),t._v(" "),s("li",[t._v("å› ä¸ºä¸éœ€è¦å¯¹å›æ»šè¿›è¡Œæ”¯æŒï¼Œæ‰€ä»¥ Redis çš„å†…éƒ¨å¯ä»¥ä¿æŒç®€å•ä¸”å¿«é€Ÿã€‚")])]),t._v(" "),s("h2",{attrs:{id:"ä¸ƒã€redis-ç®¡é“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ƒã€redis-ç®¡é“"}},[t._v("#")]),t._v(" ä¸ƒã€Redis ç®¡é“")]),t._v(" "),s("p",[t._v("Redis æ˜¯ä¸€ç§åŸºäº C/S æ¨¡å‹ä»¥åŠè¯·æ±‚/å“åº”åè®®çš„ TCP æœåŠ¡ã€‚Redis æ”¯æŒç®¡é“æŠ€æœ¯ã€‚ç®¡é“æŠ€æœ¯å…è®¸è¯·æ±‚ä»¥å¼‚æ­¥æ–¹å¼å‘é€ï¼Œå³æ—§è¯·æ±‚çš„åº”ç­”è¿˜æœªè¿”å›çš„æƒ…å†µä¸‹ï¼Œå…è®¸å‘é€æ–°è¯·æ±‚ã€‚è¿™ç§æ–¹å¼å¯ä»¥å¤§å¤§æé«˜ä¼ è¾“æ•ˆç‡ã€‚")]),t._v(" "),s("p",[t._v("åœ¨éœ€è¦æ‰¹é‡æ‰§è¡Œ Redis å‘½ä»¤æ—¶ï¼Œå¦‚æœä¸€æ¡ä¸€æ¡æ‰§è¡Œï¼Œæ˜¾ç„¶å¾ˆä½æ•ˆã€‚ä¸ºäº†å‡å°‘é€šä¿¡æ¬¡æ•°å¹¶é™ä½å»¶è¿Ÿï¼Œå¯ä»¥ä½¿ç”¨ Redis ç®¡é“åŠŸèƒ½ã€‚Redis çš„ç®¡é“ï¼ˆpipelineï¼‰åŠŸèƒ½æ²¡æœ‰æä¾›å‘½ä»¤è¡Œæ”¯æŒï¼Œä½†æ˜¯åœ¨å„ç§è¯­è¨€ç‰ˆæœ¬çš„å®¢æˆ·ç«¯ä¸­éƒ½æœ‰ç›¸åº”çš„å®ç°ã€‚")]),t._v(" "),s("p",[t._v("ä»¥ Jedis ä¸ºä¾‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Pipeline")]),t._v(" pipe "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" conn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipelined")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\npipe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("multi")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\npipe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hset")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"login:"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" token"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" user"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\npipe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("zadd")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"recent:"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" timestamp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" token"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    pipe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("zadd")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"viewed:"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" token"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" timestamp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" item"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    pipe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("zremrangeByRank")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"viewed:"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" token"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    pipe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("zincrby")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"viewed:"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" item"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\npipe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("blockquote",[s("p",[t._v("ğŸ”” æ³¨æ„ï¼šä½¿ç”¨ç®¡é“å‘é€å‘½ä»¤æ—¶ï¼ŒRedis Server ä¼šå°†éƒ¨åˆ†è¯·æ±‚æ”¾åˆ°ç¼“å­˜é˜Ÿåˆ—ä¸­ï¼ˆå ç”¨å†…å­˜ï¼‰ï¼Œæ‰§è¡Œå®Œæ¯•åä¸€æ¬¡æ€§å‘é€ç»“æœã€‚å¦‚æœéœ€è¦å‘é€å¤§é‡çš„å‘½ä»¤ï¼Œä¼šå ç”¨å¤§é‡çš„å†…å­˜ï¼Œå› æ­¤åº”è¯¥æŒ‰ç…§åˆç†æ•°é‡åˆ†æ‰¹æ¬¡çš„å¤„ç†ã€‚")])]),t._v(" "),s("h2",{attrs:{id:"å…«ã€redis-å‘å¸ƒä¸è®¢é˜…"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å…«ã€redis-å‘å¸ƒä¸è®¢é˜…"}},[t._v("#")]),t._v(" å…«ã€Redis å‘å¸ƒä¸è®¢é˜…")]),t._v(" "),s("p",[t._v("Redis æä¾›äº† 5 ä¸ªå‘å¸ƒä¸è®¢é˜…å‘½ä»¤ï¼š")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("å‘½ä»¤")]),t._v(" "),s("th",[t._v("æè¿°")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("SUBSCRIBE")])]),t._v(" "),s("td",[s("code",[t._v("SUBSCRIBE channel [channel ...]")]),t._v("â€”è®¢é˜…æŒ‡å®šé¢‘é“ã€‚")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("UNSUBSCRIBE")])]),t._v(" "),s("td",[s("code",[t._v("UNSUBSCRIBE [channel [channel ...]]")]),t._v("â€”å–æ¶ˆè®¢é˜…æŒ‡å®šé¢‘é“ã€‚")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("PUBLISH")])]),t._v(" "),s("td",[s("code",[t._v("PUBLISH channel message")]),t._v("â€”å‘é€ä¿¡æ¯åˆ°æŒ‡å®šçš„é¢‘é“ã€‚")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("PSUBSCRIBE")])]),t._v(" "),s("td",[s("code",[t._v("PSUBSCRIBE pattern [pattern ...]")]),t._v("â€”è®¢é˜…ç¬¦åˆæŒ‡å®šæ¨¡å¼çš„é¢‘é“ã€‚")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("PUNSUBSCRIBE")])]),t._v(" "),s("td",[s("code",[t._v("PUNSUBSCRIBE [pattern [pattern ...]]")]),t._v("â€”å–æ¶ˆè®¢é˜…ç¬¦åˆæŒ‡å®šæ¨¡å¼çš„é¢‘é“ã€‚")])])])]),t._v(" "),s("p",[t._v("è®¢é˜…è€…è®¢é˜…äº†é¢‘é“ä¹‹åï¼Œå‘å¸ƒè€…å‘é¢‘é“å‘é€å­—ç¬¦ä¸²æ¶ˆæ¯ä¼šè¢«æ‰€æœ‰è®¢é˜…è€…æ¥æ”¶åˆ°ã€‚")]),t._v(" "),s("p",[t._v("æŸä¸ªå®¢æˆ·ç«¯ä½¿ç”¨ SUBSCRIBE è®¢é˜…ä¸€ä¸ªé¢‘é“ï¼Œå…¶å®ƒå®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨ PUBLISH å‘è¿™ä¸ªé¢‘é“å‘é€æ¶ˆæ¯ã€‚")]),t._v(" "),s("p",[t._v("å‘å¸ƒä¸è®¢é˜…æ¨¡å¼å’Œè§‚å¯Ÿè€…æ¨¡å¼æœ‰ä»¥ä¸‹ä¸åŒï¼š")]),t._v(" "),s("ul",[s("li",[t._v("è§‚å¯Ÿè€…æ¨¡å¼ä¸­ï¼Œè§‚å¯Ÿè€…å’Œä¸»é¢˜éƒ½çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨ï¼›è€Œåœ¨å‘å¸ƒä¸è®¢é˜…æ¨¡å¼ä¸­ï¼Œå‘å¸ƒè€…ä¸è®¢é˜…è€…ä¸çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨ï¼Œå®ƒä»¬ä¹‹é—´é€šè¿‡é¢‘é“è¿›è¡Œé€šä¿¡ã€‚")]),t._v(" "),s("li",[t._v("è§‚å¯Ÿè€…æ¨¡å¼æ˜¯åŒæ­¥çš„ï¼Œå½“äº‹ä»¶è§¦å‘æ—¶ï¼Œä¸»é¢˜ä¼šå»è°ƒç”¨è§‚å¯Ÿè€…çš„æ–¹æ³•ï¼›è€Œå‘å¸ƒä¸è®¢é˜…æ¨¡å¼æ˜¯å¼‚æ­¥çš„ï¼›")])]),t._v(" "),s("hr"),t._v(" "),s("p",[s("strong",[s("em",[t._v("åˆ†å‰²çº¿ä»¥ä¸‹ä¸º Redis é›†ç¾¤åŠŸèƒ½ç‰¹æ€§")])])]),t._v(" "),s("h2",{attrs:{id:"ä¹ã€redis-å¤åˆ¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¹ã€redis-å¤åˆ¶"}},[t._v("#")]),t._v(" ä¹ã€Redis å¤åˆ¶")]),t._v(" "),s("blockquote",[s("p",[t._v("å…³ç³»å‹æ•°æ®åº“é€šå¸¸ä¼šä½¿ç”¨ä¸€ä¸ªä¸»æœåŠ¡å™¨å‘å¤šä¸ªä»æœåŠ¡å™¨å‘é€æ›´æ–°ï¼Œå¹¶ä½¿ç”¨ä»æœåŠ¡å™¨æ¥å¤„ç†æ‰€æœ‰è¯»è¯·æ±‚ï¼ŒRedis ä¹Ÿé‡‡ç”¨äº†åŒæ ·çš„æ–¹å¼æ¥å®ç°å¤åˆ¶ç‰¹æ€§ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"æ—§ç‰ˆå¤åˆ¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ—§ç‰ˆå¤åˆ¶"}},[t._v("#")]),t._v(" æ—§ç‰ˆå¤åˆ¶")]),t._v(" "),s("p",[t._v("Redis 2.8 ç‰ˆæœ¬ä»¥å‰çš„å¤åˆ¶åŠŸèƒ½åŸºäº "),s("code",[t._v("SYNC")]),t._v(" å‘½ä»¤å®ç°ã€‚")]),t._v(" "),s("p",[t._v("Redis çš„å¤åˆ¶åŠŸèƒ½åˆ†ä¸ºåŒæ­¥ï¼ˆsyncï¼‰å’Œå‘½ä»¤ä¼ æ’­ï¼ˆcommand propagateï¼‰ä¸¤ä¸ªæ“ä½œï¼š")]),t._v(" "),s("ul",[s("li",[s("strong",[s("code",[t._v("åŒæ­¥ï¼ˆsyncï¼‰")])]),t._v(" - ç”¨äºå°†ä»æœåŠ¡å™¨çš„æ•°æ®åº“çŠ¶æ€æ›´æ–°è‡³ä¸»æœåŠ¡å™¨å½“å‰çš„æ•°æ®åº“çŠ¶æ€ã€‚")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("å‘½ä»¤ä¼ æ’­ï¼ˆcommand propagateï¼‰")])]),t._v(" - å½“ä¸»æœåŠ¡å™¨çš„æ•°æ®åº“çŠ¶æ€è¢«ä¿®æ”¹ï¼Œå¯¼è‡´ä¸»ä»æ•°æ®åº“çŠ¶æ€ä¸ä¸€è‡´æ—¶ï¼Œè®©ä¸»ä»æœåŠ¡å™¨çš„æ•°æ®åº“é‡æ–°å›åˆ°ä¸€è‡´çŠ¶æ€ã€‚")])]),t._v(" "),s("p",[t._v("è¿™ç§æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼šä¸èƒ½é«˜æ•ˆå¤„ç†æ–­çº¿é‡è¿åçš„å¤åˆ¶æƒ…å†µã€‚")]),t._v(" "),s("h3",{attrs:{id:"æ–°ç‰ˆå¤åˆ¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ–°ç‰ˆå¤åˆ¶"}},[t._v("#")]),t._v(" æ–°ç‰ˆå¤åˆ¶")]),t._v(" "),s("p",[t._v("Redis 2.8 ç‰ˆæœ¬ä»¥åçš„å¤åˆ¶åŠŸèƒ½åŸºäº "),s("code",[t._v("PSYNC")]),t._v(" å‘½ä»¤å®ç°ã€‚"),s("code",[t._v("PSYNC")]),t._v(" å‘½ä»¤å…·æœ‰å®Œæ•´é‡åŒæ­¥å’Œéƒ¨åˆ†é‡åŒæ­¥ä¸¤ç§æ¨¡å¼ã€‚")]),t._v(" "),s("ul",[s("li",[s("strong",[s("code",[t._v("å®Œæ•´é‡åŒæ­¥ï¼ˆfull resychronizationï¼‰")])]),t._v(" - ç”¨äºåˆæ¬¡å¤åˆ¶ã€‚æ‰§è¡Œæ­¥éª¤ä¸ "),s("code",[t._v("SYNC")]),t._v(" å‘½ä»¤åŸºæœ¬ä¸€è‡´ã€‚")]),t._v(" "),s("li",[s("strong",[s("code",[t._v("éƒ¨åˆ†é‡åŒæ­¥ï¼ˆpartial resychronizationï¼‰")])]),t._v(" - ç”¨äºæ–­çº¿åé‡å¤åˆ¶ã€‚"),s("strong",[t._v("å¦‚æœæ¡ä»¶å…è®¸ï¼Œä¸»æœåŠ¡å™¨å¯ä»¥å°†ä¸»ä»æœåŠ¡å™¨è¿æ¥æ–­å¼€æœŸé—´æ‰§è¡Œçš„å†™å‘½ä»¤å‘é€ç»™ä»æœåŠ¡å™¨")]),t._v("ï¼Œä»æœåŠ¡å™¨åªéœ€æ¥æ”¶å¹¶æ‰§è¡Œè¿™äº›å†™å‘½ä»¤ï¼Œå³å¯å°†ä¸»ä»æœåŠ¡å™¨çš„æ•°æ®åº“çŠ¶æ€ä¿æŒä¸€è‡´ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"éƒ¨åˆ†é‡åŒæ­¥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#éƒ¨åˆ†é‡åŒæ­¥"}},[t._v("#")]),t._v(" éƒ¨åˆ†é‡åŒæ­¥")]),t._v(" "),s("p",[t._v("éƒ¨åˆ†é‡åŒæ­¥æœ‰ä¸‰ä¸ªç»„æˆéƒ¨åˆ†ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("ä¸»ä»æœåŠ¡å™¨çš„"),s("strong",[t._v("å¤åˆ¶åç§»é‡ï¼ˆreplication offsetï¼‰")])]),t._v(" "),s("li",[t._v("ä¸»æœåŠ¡å™¨çš„"),s("strong",[t._v("å¤åˆ¶ç§¯å‹ç¼“å†²åŒºï¼ˆreplication backlogï¼‰")])]),t._v(" "),s("li",[s("strong",[t._v("æœåŠ¡å™¨çš„è¿è¡Œ ID")])])]),t._v(" "),s("h3",{attrs:{id:"psync-å‘½ä»¤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#psync-å‘½ä»¤"}},[t._v("#")]),t._v(" PSYNC å‘½ä»¤")]),t._v(" "),s("p",[t._v("ä»æœåŠ¡å™¨å‘è¦å¤åˆ¶çš„ä¸»æœåŠ¡å™¨å‘é€ "),s("code",[t._v("PSYNC <runid> <offset>")]),t._v(" å‘½ä»¤")]),t._v(" "),s("ul",[s("li",[t._v("å‡å¦‚ä¸»ä»æœåŠ¡å™¨çš„ "),s("strong",[t._v("master run id ç›¸åŒ")]),t._v("ï¼Œå¹¶ä¸”"),s("strong",[t._v("æŒ‡å®šçš„åç§»é‡ï¼ˆoffsetï¼‰åœ¨å†…å­˜ç¼“å†²åŒºä¸­è¿˜æœ‰æ•ˆ")]),t._v("ï¼Œå¤åˆ¶å°±ä¼šä»ä¸Šæ¬¡ä¸­æ–­çš„ç‚¹å¼€å§‹ç»§ç»­ã€‚")]),t._v(" "),s("li",[t._v("å¦‚æœå…¶ä¸­ä¸€ä¸ªæ¡ä»¶ä¸æ»¡è¶³ï¼Œå°±ä¼šè¿›è¡Œå®Œå…¨é‡æ–°åŒæ­¥ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"å¿ƒè·³æ£€æµ‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¿ƒè·³æ£€æµ‹"}},[t._v("#")]),t._v(" å¿ƒè·³æ£€æµ‹")]),t._v(" "),s("p",[t._v("ä¸»æœåŠ¡å™¨é€šè¿‡å‘ä»æœåŠ¡ä¼ æ’­å‘½ä»¤æ¥æ›´æ–°ä»æœåŠ¡å™¨çŠ¶æ€ï¼Œä¿æŒä¸»ä»æ•°æ®ä¸€è‡´ã€‚")]),t._v(" "),s("p",[t._v("ä»æœåŠ¡å™¨é€šè¿‡å‘ä¸»æœåŠ¡å™¨å‘é€å‘½ä»¤ "),s("code",[t._v("REPLCONF ACK <replication_offset>")]),t._v(" æ¥è¿›è¡Œå¿ƒè·³æ£€æµ‹ï¼Œä»¥åŠå‘½ä»¤ä¸¢å¤±æ£€æµ‹ã€‚")]),t._v(" "),s("blockquote",[s("p",[t._v("ğŸ’¡ æ›´è¯¦ç»†çš„ç‰¹æ€§åŠåŸç†è¯´æ˜è¯·å‚è€ƒï¼š"),s("RouterLink",{attrs:{to:"/12.æ•°æ®åº“/05.KVæ•°æ®åº“/01.Redis/05.Rediså¤åˆ¶.html"}},[t._v("Redis å¤åˆ¶")])],1)]),t._v(" "),s("h2",{attrs:{id:"åã€redis-å“¨å…µ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åã€redis-å“¨å…µ"}},[t._v("#")]),t._v(" åã€Redis å“¨å…µ")]),t._v(" "),s("p",[t._v("Sentinelï¼ˆå“¨å…µï¼‰å¯ä»¥ç›‘å¬ä¸»æœåŠ¡å™¨ï¼Œå¹¶åœ¨ä¸»æœåŠ¡å™¨è¿›å…¥ä¸‹çº¿çŠ¶æ€æ—¶ï¼Œè‡ªåŠ¨ä»ä»æœåŠ¡å™¨ä¸­é€‰ä¸¾å‡ºæ–°çš„ä¸»æœåŠ¡å™¨ã€‚")]),t._v(" "),s("blockquote",[s("p",[t._v("ğŸ’¡ æ›´è¯¦ç»†çš„ç‰¹æ€§åŠåŸç†è¯´æ˜è¯·å‚è€ƒï¼š"),s("RouterLink",{attrs:{to:"/12.æ•°æ®åº“/05.KVæ•°æ®åº“/01.Redis/06.Rediså“¨å…µ.html"}},[t._v("Redis å“¨å…µ")])],1)]),t._v(" "),s("h2",{attrs:{id:"åä¸€ã€redis-é›†ç¾¤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åä¸€ã€redis-é›†ç¾¤"}},[t._v("#")]),t._v(" åä¸€ã€Redis é›†ç¾¤")]),t._v(" "),s("p",[t._v("åˆ†ç‰‡æ˜¯å°†æ•°æ®åˆ’åˆ†ä¸ºå¤šä¸ªéƒ¨åˆ†çš„æ–¹æ³•ï¼Œå¯ä»¥å°†æ•°æ®å­˜å‚¨åˆ°å¤šå°æœºå™¨é‡Œé¢ï¼Œä¹Ÿå¯ä»¥ä»å¤šå°æœºå™¨é‡Œé¢è·å–æ•°æ®ï¼Œè¿™ç§æ–¹æ³•åœ¨è§£å†³æŸäº›é—®é¢˜æ—¶å¯ä»¥è·å¾—çº¿æ€§çº§åˆ«çš„æ€§èƒ½æå‡ã€‚")]),t._v(" "),s("p",[t._v("å‡è®¾æœ‰ 4 ä¸ª Reids å®ä¾‹ R0ï¼ŒR1ï¼ŒR2ï¼ŒR3ï¼Œè¿˜æœ‰å¾ˆå¤šè¡¨ç¤ºç”¨æˆ·çš„é”® user:1ï¼Œuser:2ï¼Œ... ç­‰ç­‰ï¼Œæœ‰ä¸åŒçš„æ–¹å¼æ¥é€‰æ‹©ä¸€ä¸ªæŒ‡å®šçš„é”®å­˜å‚¨åœ¨å“ªä¸ªå®ä¾‹ä¸­ã€‚æœ€ç®€å•çš„æ–¹å¼æ˜¯èŒƒå›´åˆ†ç‰‡ï¼Œä¾‹å¦‚ç”¨æˆ· id ä» 0~1000 çš„å­˜å‚¨åˆ°å®ä¾‹ R0 ä¸­ï¼Œç”¨æˆ· id ä» 1001~2000 çš„å­˜å‚¨åˆ°å®ä¾‹ R1 ä¸­ï¼Œç­‰ç­‰ã€‚ä½†æ˜¯è¿™æ ·éœ€è¦ç»´æŠ¤ä¸€å¼ æ˜ å°„èŒƒå›´è¡¨ï¼Œç»´æŠ¤æ“ä½œä»£ä»·å¾ˆé«˜ã€‚è¿˜æœ‰ä¸€ç§æ–¹å¼æ˜¯å“ˆå¸Œåˆ†ç‰‡ï¼Œä½¿ç”¨ CRC32 å“ˆå¸Œå‡½æ•°å°†é”®è½¬æ¢ä¸ºä¸€ä¸ªæ•°å­—ï¼Œå†å¯¹å®ä¾‹æ•°é‡æ±‚æ¨¡å°±èƒ½çŸ¥é“åº”è¯¥å­˜å‚¨çš„å®ä¾‹ã€‚")]),t._v(" "),s("p",[t._v("ä¸»è¦æœ‰ä¸‰ç§åˆ†ç‰‡æ–¹å¼ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("å®¢æˆ·ç«¯åˆ†ç‰‡ï¼šå®¢æˆ·ç«¯ä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œç­‰ç®—æ³•å†³å®šé”®åº”å½“åˆ†å¸ƒåˆ°å“ªä¸ªèŠ‚ç‚¹ã€‚")]),t._v(" "),s("li",[t._v("ä»£ç†åˆ†ç‰‡ï¼šå°†å®¢æˆ·ç«¯è¯·æ±‚å‘é€åˆ°ä»£ç†ä¸Šï¼Œç”±ä»£ç†è½¬å‘è¯·æ±‚åˆ°æ­£ç¡®çš„èŠ‚ç‚¹ä¸Šã€‚")]),t._v(" "),s("li",[t._v("æœåŠ¡å™¨åˆ†ç‰‡ï¼šRedis Clusterï¼ˆå®˜æ–¹çš„ Redis é›†ç¾¤è§£å†³æ–¹æ¡ˆï¼‰ã€‚")])]),t._v(" "),s("h2",{attrs:{id:"åäºŒã€redis-client"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åäºŒã€redis-client"}},[t._v("#")]),t._v(" åäºŒã€Redis Client")]),t._v(" "),s("p",[t._v("Redis ç¤¾åŒºä¸­æœ‰å¤šç§ç¼–ç¨‹è¯­è¨€çš„å®¢æˆ·ç«¯ï¼Œå¯ä»¥åœ¨è¿™é‡ŒæŸ¥æ‰¾åˆé€‚çš„å®¢æˆ·ç«¯ï¼š"),s("a",{attrs:{href:"https://redis.io/clients",target:"_blank",rel:"noopener noreferrer"}},[t._v("Redis å®˜æ–¹ç½—åˆ—çš„å®¢æˆ·ç«¯æ¸…å•"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("redis å®˜æ–¹æ¨èçš„ Java Redis Clientï¼š")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/xetorthio/jedis",target:"_blank",rel:"noopener noreferrer"}},[t._v("jedis"),s("OutboundLink")],1),t._v(" - æœ€æµè¡Œçš„ Redis Java å®¢æˆ·ç«¯")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/redisson/redisson",target:"_blank",rel:"noopener noreferrer"}},[t._v("redisson"),s("OutboundLink")],1),t._v(" - é¢å¤–æä¾›äº†å¾ˆå¤šçš„åˆ†å¸ƒå¼æœåŠ¡ç‰¹æ€§ï¼Œå¦‚ï¼šåˆ†å¸ƒå¼é”ã€åˆ†å¸ƒå¼ Java å¸¸ç”¨å¯¹è±¡ï¼ˆBitSetã€BlockingQueueã€CountDownLatch ç­‰ï¼‰")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/lettuce-io/lettuce-core",target:"_blank",rel:"noopener noreferrer"}},[t._v("lettuce"),s("OutboundLink")],1),t._v(" - Spring Boot 2.0 é»˜è®¤ Redis å®¢æˆ·ç«¯")])]),t._v(" "),s("h2",{attrs:{id:"æ‰©å±•é˜…è¯»"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ‰©å±•é˜…è¯»"}},[t._v("#")]),t._v(" æ‰©å±•é˜…è¯»")]),t._v(" "),s("blockquote",[s("p",[t._v("ğŸ’¡ Redis å¸¸ç”¨äºåˆ†å¸ƒå¼ç¼“å­˜ï¼Œæœ‰å…³ç¼“å­˜çš„ç‰¹æ€§å’ŒåŸç†è¯·å‚è€ƒï¼š"),s("a",{attrs:{href:"https://dunwu.github.io/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BC%93%E5%AD%98.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("ç¼“å­˜åŸºæœ¬åŸç†"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"å‚è€ƒèµ„æ–™"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒèµ„æ–™"}},[t._v("#")]),t._v(" å‚è€ƒèµ„æ–™")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("å®˜ç½‘")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://redis.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Redis å®˜ç½‘"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/antirez/redis",target:"_blank",rel:"noopener noreferrer"}},[t._v("Redis github"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"http://redis.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Redis å®˜æ–¹æ–‡æ¡£ä¸­æ–‡ç‰ˆ"),s("OutboundLink")],1)])])]),t._v(" "),s("li",[s("strong",[t._v("ä¹¦ç±")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://item.jd.com/11791607.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("ã€ŠRedis å®æˆ˜ã€‹"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://item.jd.com/11486101.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("ã€ŠRedis è®¾è®¡ä¸å®ç°ã€‹"),s("OutboundLink")],1)])])]),t._v(" "),s("li",[s("strong",[t._v("æ•™ç¨‹")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"http://redisdoc.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Redis å‘½ä»¤å‚è€ƒ"),s("OutboundLink")],1)])])]),t._v(" "),s("li",[s("strong",[t._v("èµ„æºæ±‡æ€»")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/JamzyWang/awesome-redis",target:"_blank",rel:"noopener noreferrer"}},[t._v("awesome-redis"),s("OutboundLink")],1)])])]),t._v(" "),s("li",[s("strong",[t._v("Redis Client")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://docs.spring.io/spring-data/redis/docs/1.8.13.RELEASE/reference/html/",target:"_blank",rel:"noopener noreferrer"}},[t._v("spring-data-redis å®˜æ–¹æ–‡æ¡£"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/redisson/redisson/wiki/%E7%9B%AE%E5%BD%95",target:"_blank",rel:"noopener noreferrer"}},[t._v("redisson å®˜æ–¹æ–‡æ¡£(ä¸­æ–‡,ç•¥æœ‰æ»å)"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/redisson/redisson/wiki/Table-of-Content",target:"_blank",rel:"noopener noreferrer"}},[t._v("redisson å®˜æ–¹æ–‡æ¡£(è‹±æ–‡)"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.jianshu.com/p/82f0d5abb002",target:"_blank",rel:"noopener noreferrer"}},[t._v("CRUG | Redisson PRO vs. Jedis: Which Is Faster? ç¿»è¯‘"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://blog.csdn.net/everlasting_188/article/details/51073505",target:"_blank",rel:"noopener noreferrer"}},[t._v("redis åˆ†å¸ƒé” Redisson æ€§èƒ½æµ‹è¯•"),s("OutboundLink")],1)])])])])])}),[],!1,null,null,null);s.default=r.exports}}]);